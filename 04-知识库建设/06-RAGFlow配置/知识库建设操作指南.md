# RAGFlow 知识库建设操作指南

## 📋 建设目标

在RAGFlow上创建8个知识库，配置API访问，并导入初始知识。

---

## 🎯 第一步：在RAGFlow上创建知识库

### 1.1 登录RAGFlow Web界面

1. **访问RAGFlow**
   - 打开浏览器，访问RAGFlow Web界面
   - 地址：`https://ragflow.suuntoyun.com`
   - 或者使用公网IP：`http://119.130.140.184:9380`

2. **登录账号**
   - 使用你的RAGFlow账号登录
   - 如果没有账号，需要先创建账号

### 1.2 创建8个知识库

按照以下顺序创建知识库：

#### 知识库1：组织架构知识库
- **知识库名称**：`organization_knowledge`
- **知识库描述**：存储组织架构相关的知识（组织架构设计文档、岗位职责定义、流程设计文档、协作机制说明）
- **知识库类型**：根据RAGFlow界面选择（通常是"文档知识库"）
- **记录知识库ID**：创建后会生成知识库ID，需要记录下来

#### 知识库2：项目经验知识库
- **知识库名称**：`project_experience`
- **知识库描述**：存储项目执行过程中的经验（项目成功经验、项目失败教训、问题解决方案、最佳实践）

#### 知识库3：技术知识库
- **知识库名称**：`technical_knowledge`
- **知识库描述**：存储技术相关的知识（技术选型文档、技术方案设计、技术实现经验、技术问题解决方案）

#### 知识库4：业务知识库
- **知识库名称**：`business_knowledge`
- **知识库描述**：存储业务相关的知识（业务需求分析、业务流程设计、业务规则定义、业务场景说明）

#### 知识库5：数字人知识库
- **知识库名称**：`digital_human_knowledge`
- **知识库描述**：存储数字人相关的知识（数字人角色定义、数字人工作模式、数字人协作经验、数字人能力评估）

#### 知识库6：错误知识库
- **知识库名称**：`error_knowledge`
- **知识库描述**：存储错误和教训（错误记录、错误原因分析、错误解决方案、错误预防措施）

#### 知识库7：最佳实践知识库
- **知识库名称**：`best_practices`
- **知识库描述**：存储最佳实践和闪光点（闪光点记录、成功经验总结、最佳实践文档、可复用方案）

#### 知识库8：公司发展知识库
- **知识库名称**：`company_development`
- **知识库描述**：存储公司发展相关的知识（公司战略分析、业务发展趋势、项目关联分析、战略建议）

### 1.3 记录知识库信息

创建完成后，记录每个知识库的信息：

| 知识库名称 | 知识库ID | 创建时间 | 状态 |
|-----------|---------|---------|------|
| organization_knowledge | | | |
| project_experience | | | |
| technical_knowledge | | | |
| business_knowledge | | | |
| digital_human_knowledge | | | |
| error_knowledge | | | |
| best_practices | | | |
| company_development | | | |

---

## 🔧 第二步：配置API访问

### 2.1 获取API密钥

1. **在RAGFlow Web界面中**
   - 进入"设置"或"API配置"页面
   - 找到"API密钥"或"Access Token"
   - 复制API密钥（如果还没有，需要创建）

2. **记录API信息**
   - API Base URL：`http://your-dell-server-ip:port/api/v1`（通常是 `http://your-server-ip:9380/api/v1`）
   - API密钥：`your-api-key`

### 2.2 配置环境变量

1. **找到环境变量配置文件**
   - 位置：`~/DeveloperConfig/环境变量/.env.work`
   - 或者：项目根目录的 `.env` 文件

2. **添加RAGFlow配置**
   ```bash
   # RAGFlow配置
   RAGFLOW_BASE_URL=http://your-dell-server-ip:9380
   RAGFLOW_API_KEY=your-api-key
   RAGFLOW_API_VERSION=v1
   ```

3. **为每个知识库添加ID**（可选，如果API需要）
   ```bash
   # RAGFlow知识库ID
   RAGFLOW_KB_ORGANIZATION=your-organization-kb-id
   RAGFLOW_KB_PROJECT_EXPERIENCE=your-project-experience-kb-id
   RAGFLOW_KB_TECHNICAL=your-technical-kb-id
   RAGFLOW_KB_BUSINESS=your-business-kb-id
   RAGFLOW_KB_DIGITAL_HUMAN=your-digital-human-kb-id
   RAGFLOW_KB_ERROR=your-error-kb-id
   RAGFLOW_KB_BEST_PRACTICES=your-best-practices-kb-id
   RAGFLOW_KB_COMPANY_DEVELOPMENT=your-company-development-kb-id
   ```

### 2.3 测试API连接

运行测试脚本验证配置：

```bash
cd "04-知识库建设/06-RAGFlow配置"
python3 test_ragflow_connection.py
```

如果测试通过，说明API配置正确。

---

## 📚 第三步：导入初始知识

### 3.1 准备初始知识文档

需要导入的文档清单：

#### organization_knowledge（组织架构知识库）
- [ ] `01-项目构想/组织架构详细设计.md`
- [ ] `01-项目构想/项目章程.md`
- [ ] `02-数字人设计/` 目录下的所有角色定义

#### project_experience（项目经验知识库）
- [ ] 项目执行过程中的经验文档（如果有）
- [ ] 问题解决方案文档（如果有）

#### technical_knowledge（技术知识库）
- [ ] `01-项目构想/技术选型.md`
- [ ] `03-技术实现/` 目录下的技术文档

#### business_knowledge（业务知识库）
- [ ] 业务需求分析文档（如果有）
- [ ] 业务流程设计文档（如果有）

#### digital_human_knowledge（数字人知识库）
- [ ] `02-数字人设计/00-智能产品规划师/角色定义.md`
- [ ] `02-数字人设计/00-智能产品规划师/` 目录下的所有能力文档
- [ ] `02-数字人设计/04-实时记录员/角色定义.md`
- [ ] `02-数字人设计/05-质量观察员/角色定义.md`
- [ ] `02-数字人设计/06-知识管理员/角色定义.md`
- [ ] `02-数字人设计/项目经理.md`
- [ ] `02-数字人设计/系统架构师.md`
- [ ] `02-数字人设计/前端工程师.md`
- [ ] `02-数字人设计/后端工程师.md`
- [ ] `02-数字人设计/运维工程师.md`

#### error_knowledge（错误知识库）
- [ ] 错误记录文档（如果有）
- [ ] 问题解决记录（如果有）

#### best_practices（最佳实践知识库）
- [ ] 最佳实践文档（如果有）
- [ ] 成功经验总结（如果有）

#### company_development（公司发展知识库）
- [ ] 公司战略分析文档（如果有）
- [ ] 业务发展趋势文档（如果有）

### 3.2 导入方式

#### 方式1：通过RAGFlow Web界面上传
1. 登录RAGFlow Web界面
2. 选择对应的知识库
3. 点击"上传文档"或"导入文档"
4. 选择要导入的文档
5. 等待文档解析和索引完成

#### 方式2：通过API批量导入
使用提供的导入脚本：

```bash
cd "04-知识库建设/06-RAGFlow配置"
python3 import_initial_knowledge.py
```

### 3.3 验证导入结果

1. **在RAGFlow Web界面中**
   - 进入每个知识库
   - 检查文档数量是否正确
   - 检查文档是否已解析和索引

2. **通过API测试检索**
   ```python
   # 测试知识检索
   from ragflow_client import RAGFlowClient

   client = RAGFlowClient()
   results = client.search_knowledge("organization_knowledge", "组织架构", top_k=5)
   print(results)
   ```

---

## ✅ 检查清单

### 知识库创建
- [ ] 8个知识库已创建
- [ ] 每个知识库的名称和描述正确
- [ ] 每个知识库的ID已记录

### API配置
- [ ] API Base URL已配置
- [ ] API密钥已配置
- [ ] 环境变量已更新
- [ ] API连接测试通过

### 初始知识导入
- [ ] organization_knowledge：组织架构文档已导入
- [ ] project_experience：项目经验文档已导入（如果有）
- [ ] technical_knowledge：技术文档已导入
- [ ] business_knowledge：业务文档已导入（如果有）
- [ ] digital_human_knowledge：数字人角色定义已导入
- [ ] error_knowledge：错误记录已导入（如果有）
- [ ] best_practices：最佳实践已导入（如果有）
- [ ] company_development：公司发展文档已导入（如果有）

### 功能验证
- [ ] 知识检索功能正常
- [ ] 知识保存功能正常
- [ ] 知识更新功能正常

---

## 📝 操作步骤总结

### 快速操作流程

1. **登录RAGFlow Web界面**
   ```
   访问：http://your-dell-server-ip:9380
   登录你的账号
   ```

2. **创建8个知识库**
   ```
   依次创建：
   - organization_knowledge
   - project_experience
   - technical_knowledge
   - business_knowledge
   - digital_human_knowledge
   - error_knowledge
   - best_practices
   - company_development
   ```

3. **记录知识库ID**
   ```
   在RAGFlow界面中，记录每个知识库的ID
   保存到环境变量配置文件
   ```

4. **配置API访问**
   ```
   获取API密钥
   更新环境变量配置文件
   测试API连接
   ```

5. **导入初始知识**
   ```
   准备初始知识文档
   通过Web界面或API导入
   验证导入结果
   ```

---

## 🔧 工具和脚本

### 已有工具
1. **test_ragflow_connection.py** - 测试RAGFlow连接
2. **ragflow_client.py** - RAGFlow API客户端
3. **discussion_helper_ragflow.py** - 讨论记录工具（使用RAGFlow）

### 需要创建的工具
1. **import_initial_knowledge.py** - 批量导入初始知识脚本
2. **knowledge_base_manager.py** - 知识库管理工具

---

## 📞 遇到问题？

### 常见问题

1. **无法访问RAGFlow**
   - 检查服务器是否运行
   - 检查网络连接
   - 检查防火墙设置

2. **API连接失败**
   - 检查API Base URL是否正确
   - 检查API密钥是否有效
   - 检查环境变量是否已加载

3. **文档导入失败**
   - 检查文档格式是否支持
   - 检查文档大小是否超限
   - 检查知识库权限

---

## ✅ 完成标志

知识库建设完成的标准：
- ✅ 8个知识库已创建
- ✅ API访问配置完成
- ✅ 初始知识已导入
- ✅ 知识检索功能正常
- ✅ 知识保存功能正常

---

**准备好开始了吗？按照上述步骤操作即可！**
