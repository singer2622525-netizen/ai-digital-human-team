# å¯†ç æ•°æ®åº“è®¾è®¡æ–‡æ¡£

## ğŸ¯ è®¾è®¡ç›®æ ‡

åˆ›å»ºä¸€ä¸ªæœ¬åœ°å¯†ç ç®¡ç†æ•°æ®åº“ï¼Œé›†ä¸­å­˜å‚¨å’Œç®¡ç†æ‰€æœ‰æœåŠ¡çš„è´¦å·å¯†ç ï¼Œæ–¹ä¾¿æ•°å­—äººè°ƒç”¨ã€‚

### æ ¸å¿ƒéœ€æ±‚
1. **é›†ä¸­ç®¡ç†**ï¼šæ‰€æœ‰è´¦å·å¯†ç ç»Ÿä¸€å­˜å‚¨
2. **å®‰å…¨åŠ å¯†**ï¼šå¯†ç åŠ å¯†å­˜å‚¨ï¼Œé˜²æ­¢æ³„éœ²
3. **æ–¹ä¾¿è°ƒç”¨**ï¼šæ•°å­—äººå¯ä»¥é€šè¿‡APIè½»æ¾è·å–
4. **æœ¬åœ°å­˜å‚¨**ï¼šæ•°æ®å­˜å‚¨åœ¨Macæœ¬åœ°ï¼Œå®‰å…¨å¯æ§
5. **åˆ†ç±»ç®¡ç†**ï¼šæŒ‰æœåŠ¡ç±»å‹åˆ†ç±»å­˜å‚¨

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ•°æ®åº“é€‰æ‹©ï¼šSQLite

**ä¸ºä»€ä¹ˆé€‰æ‹©SQLiteï¼Ÿ**
- âœ… è½»é‡çº§ï¼Œæ— éœ€å•ç‹¬æœåŠ¡å™¨
- âœ… æœ¬åœ°æ–‡ä»¶å­˜å‚¨ï¼Œæ•°æ®å®Œå…¨å¯æ§
- âœ… PythonåŸç”Ÿæ”¯æŒï¼Œæ— éœ€é¢å¤–ä¾èµ–
- âœ… é€‚åˆå•ç”¨æˆ·åœºæ™¯
- âœ… æ€§èƒ½è¶³å¤Ÿï¼Œæ”¯æŒå¹¶å‘è¯»å–
- âœ… **ä¸é¡¹ç›®æ†ç»‘ï¼Œä¸åˆ†å‰²**

### å­˜å‚¨ä½ç½®

**é¡¹ç›®å†…å­˜å‚¨ï¼Œä¸é¡¹ç›®æ†ç»‘åœ¨ä¸€èµ·**

```
é¡¹ç›®æ ¹ç›®å½•/
â””â”€â”€ 03-æŠ€æœ¯å®ç°/
    â””â”€â”€ 05-é…ç½®ç®¡ç†/
        â”œâ”€â”€ credentials_manager.py  # å¯†ç ç®¡ç†å·¥å…·
        â”œâ”€â”€ credentials_api.py      # APIæ¥å£ï¼ˆä¾›æ•°å­—äººè°ƒç”¨ï¼‰
        â”œâ”€â”€ credentials_auto.py     # è‡ªåŠ¨æ”¶é›†å’Œè°ƒç”¨
        â”œâ”€â”€ credentials_collector.py # è‡ªåŠ¨æ”¶é›†å™¨
        â””â”€â”€ å¯†ç æ•°æ®åº“/
            â””â”€â”€ credentials.db       # SQLiteæ•°æ®åº“ï¼ˆåŠ å¯†ï¼‰
```

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- âœ… **ä¸é¡¹ç›®æ†ç»‘ï¼Œæœ¬è´¨ä¸Šä¸åˆ†å‰²** - æ•°æ®åº“æ–‡ä»¶åœ¨é¡¹ç›®ç›®å½•å†…
- âœ… **é¡¹ç›®è¿ç§»æ—¶æ•°æ®åº“ä¸€èµ·è¿ç§»** - ä¸ä¼šä¸¢å¤±
- âœ… **æœ¬åœ°å­˜å‚¨ï¼Œå®‰å…¨å¯æ§** - æ•°æ®å®Œå…¨åœ¨Macæœ¬åœ°
- âœ… **æ— éœ€é¢å¤–éƒ¨ç½²** - SQLiteå¼€ç®±å³ç”¨
- âœ… **ç‰ˆæœ¬æ§åˆ¶å‹å¥½** - æ•°æ®åº“æ–‡ä»¶åœ¨.gitignoreä¸­

---

## ğŸ“Š æ•°æ®åº“ç»“æ„è®¾è®¡

### è¡¨1ï¼šservicesï¼ˆæœåŠ¡è¡¨ï¼‰

å­˜å‚¨æœåŠ¡çš„åŸºæœ¬ä¿¡æ¯ã€‚

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| id | INTEGER PRIMARY KEY | æœåŠ¡ID | 1 |
| service_name | TEXT UNIQUE | æœåŠ¡åç§° | "RAGFlow" |
| service_type | TEXT | æœåŠ¡ç±»å‹ | "çŸ¥è¯†åº“" |
| description | TEXT | æœåŠ¡æè¿° | "å…¬å¸DellæœåŠ¡å™¨ä¸Šçš„RAGFlowæœåŠ¡" |
| base_url | TEXT | æœåŠ¡åœ°å€ | "https://ragflow.suuntoyun.com" |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ | "2024-01-01 00:00:00" |
| updated_at | TIMESTAMP | æ›´æ–°æ—¶é—´ | "2024-01-01 00:00:00" |

### è¡¨2ï¼šcredentialsï¼ˆå‡­è¯è¡¨ï¼‰

å­˜å‚¨è´¦å·å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ï¼ˆåŠ å¯†å­˜å‚¨ï¼‰ã€‚

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| id | INTEGER PRIMARY KEY | å‡­è¯ID | 1 |
| service_id | INTEGER | å…³è”æœåŠ¡ID | 1 |
| credential_type | TEXT | å‡­è¯ç±»å‹ | "username_password" |
| key_name | TEXT | é”®å | "username" |
| encrypted_value | BLOB | åŠ å¯†åçš„å€¼ | (åŠ å¯†åçš„äºŒè¿›åˆ¶æ•°æ®) |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ | "2024-01-01 00:00:00" |
| updated_at | TIMESTAMP | æ›´æ–°æ—¶é—´ | "2024-01-01 00:00:00" |

**å‡­è¯ç±»å‹**ï¼š
- `username_password`ï¼šç”¨æˆ·åå¯†ç 
- `api_key`ï¼šAPIå¯†é’¥
- `token`ï¼šè®¿é—®ä»¤ç‰Œ
- `domain`ï¼šåŸŸå
- `ip_address`ï¼šIPåœ°å€
- `port`ï¼šç«¯å£å·
- `other`ï¼šå…¶ä»–

### è¡¨3ï¼šservice_metadataï¼ˆæœåŠ¡å…ƒæ•°æ®è¡¨ï¼‰

å­˜å‚¨æœåŠ¡çš„é¢å¤–é…ç½®ä¿¡æ¯ã€‚

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| id | INTEGER PRIMARY KEY | å…ƒæ•°æ®ID | 1 |
| service_id | INTEGER | å…³è”æœåŠ¡ID | 1 |
| key | TEXT | é”®å | "ssh_port" |
| value | TEXT | å€¼ | "2222" |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ | "2024-01-01 00:00:00" |

---

## ğŸ” å®‰å…¨è®¾è®¡

### åŠ å¯†æ–¹æ¡ˆ

ä½¿ç”¨ **Fernetå¯¹ç§°åŠ å¯†**ï¼ˆæ¥è‡ªcryptographyåº“ï¼‰ï¼š

1. **ä¸»å¯†ç åŠ å¯†**ï¼š
   - ä½¿ç”¨Macçš„Keychainå­˜å‚¨ä¸»å¯†ç 
   - æˆ–è€…ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆä¸æ¨èï¼Œä½†å¯é€‰ï¼‰

2. **æ•°æ®åŠ å¯†**ï¼š
   - ä½¿ç”¨ä¸»å¯†ç ç”ŸæˆåŠ å¯†å¯†é’¥
   - æ‰€æœ‰æ•æ„Ÿæ•°æ®åŠ å¯†åå­˜å‚¨

3. **è®¿é—®æ§åˆ¶**ï¼š
   - æ•°æ®åº“æ–‡ä»¶æƒé™ï¼š600ï¼ˆåªæœ‰æ‰€æœ‰è€…å¯è¯»å†™ï¼‰
   - ä¸»å¯†ç éªŒè¯åæ‰èƒ½è®¿é—®

### å¯†é’¥ç®¡ç†

```python
# å¯†é’¥ç”Ÿæˆæµç¨‹
ä¸»å¯†ç  â†’ PBKDF2 â†’ åŠ å¯†å¯†é’¥ â†’ FernetåŠ å¯†å™¨
```

---

## ğŸ“ æœåŠ¡åˆ†ç±»

### 1. çŸ¥è¯†åº“æœåŠ¡
- RAGFlow
- ChromaDBï¼ˆå¦‚æœä½¿ç”¨ï¼‰
- å…¶ä»–çŸ¥è¯†åº“

### 2. ç½‘ç»œæœåŠ¡
- åŸŸåæœåŠ¡ï¼ˆDuckDNSç­‰ï¼‰
- å†…ç½‘ç©¿é€ï¼ˆfrpã€ngrokç­‰ï¼‰
- VPNæœåŠ¡

### 3. å¼€å‘æœåŠ¡
- GitHub
- GitLab
- Docker Registry

### 4. äº‘æœåŠ¡
- AWS
- Azure
- é˜¿é‡Œäº‘

### 5. å…¶ä»–æœåŠ¡
- æ•°æ®åº“
- æ¶ˆæ¯é˜Ÿåˆ—
- ç›‘æ§æœåŠ¡

---

## ğŸ”§ APIè®¾è®¡

### Python API

```python
from credentials_api import CredentialsManager

# åˆå§‹åŒ–
manager = CredentialsManager()

# æ·»åŠ æœåŠ¡
service_id = manager.add_service(
    service_name="RAGFlow",
    service_type="çŸ¥è¯†åº“",
    base_url="https://ragflow.suuntoyun.com"
)

# æ·»åŠ å‡­è¯
manager.add_credential(
    service_id=service_id,
    credential_type="username_password",
    key_name="username",
    value="your-username"
)

manager.add_credential(
    service_id=service_id,
    credential_type="username_password",
    key_name="password",
    value="your-password"
)

# è·å–å‡­è¯
credentials = manager.get_credentials(service_name="RAGFlow")
# è¿”å›: {"username": "your-username", "password": "your-password"}

# è·å–æœåŠ¡ä¿¡æ¯
service = manager.get_service(service_name="RAGFlow")
# è¿”å›: {"base_url": "...", "credentials": {...}}
```

### å‘½ä»¤è¡Œå·¥å…·

```bash
# æ·»åŠ æœåŠ¡
python credentials_manager.py add-service RAGFlow --type çŸ¥è¯†åº“ --url https://ragflow.suuntoyun.com

# æ·»åŠ å‡­è¯
python credentials_manager.py add-credential RAGFlow --type username_password --key username --value your-username

# è·å–å‡­è¯
python credentials_manager.py get-credentials RAGFlow

# åˆ—å‡ºæ‰€æœ‰æœåŠ¡
python credentials_manager.py list-services
```

---

## ğŸš€ å®ç°è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€åŠŸèƒ½
1. âœ… æ•°æ®åº“è®¾è®¡å’Œåˆ›å»º
2. âœ… åŠ å¯†åŠŸèƒ½å®ç°
3. âœ… åŸºç¡€CRUDæ“ä½œ
4. âœ… å‘½ä»¤è¡Œå·¥å…·

### ç¬¬äºŒé˜¶æ®µï¼šAPIæ¥å£
1. â³ Python APIå°è£…
2. â³ æ•°å­—äººè°ƒç”¨æ¥å£
3. â³ ç¯å¢ƒå˜é‡è‡ªåŠ¨åŒæ­¥

### ç¬¬ä¸‰é˜¶æ®µï¼šé«˜çº§åŠŸèƒ½
1. â³ å¯†ç ç”Ÿæˆå™¨
2. â³ å¯†ç å¼ºåº¦æ£€æŸ¥
3. â³ è‡ªåŠ¨å¤‡ä»½
4. â³ å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½

---

## ğŸ“‹ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šæ•°å­—äººéœ€è¦RAGFlowå‡­è¯

```python
from credentials_api import CredentialsManager

manager = CredentialsManager()
ragflow_config = manager.get_service("RAGFlow")

# è‡ªåŠ¨è®¾ç½®ç¯å¢ƒå˜é‡
os.environ['RAGFLOW_BASE_URL'] = ragflow_config['base_url']
os.environ['RAGFLOW_USERNAME'] = ragflow_config['credentials']['username']
os.environ['RAGFLOW_PASSWORD'] = ragflow_config['credentials']['password']
```

### åœºæ™¯2ï¼šæ·»åŠ æ–°æœåŠ¡

```bash
# æ·»åŠ å†…ç½‘ç©¿é€æœåŠ¡
python credentials_manager.py add-service frp --type å†…ç½‘ç©¿é€ --url http://frp.example.com

# æ·»åŠ å‡­è¯
python credentials_manager.py add-credential frp --type username_password --key username --value frp-user
python credentials_manager.py add-credential frp --type username_password --key password --value frp-password
```

### åœºæ™¯3ï¼šæ‰¹é‡å¯¼å…¥ç°æœ‰é…ç½®

```python
# ä»ç¯å¢ƒå˜é‡æ–‡ä»¶å¯¼å…¥
python credentials_manager.py import-from-env ~/DeveloperConfig/ç¯å¢ƒå˜é‡/.env.work
```

---

## ğŸ”’ å®‰å…¨å»ºè®®

1. **ä¸»å¯†ç ç®¡ç†**
   - ä½¿ç”¨Mac Keychainå­˜å‚¨ä¸»å¯†ç 
   - æˆ–è€…ä½¿ç”¨å¼ºå¯†ç ï¼Œå®šæœŸæ›´æ¢

2. **æ•°æ®åº“æ–‡ä»¶ä¿æŠ¤**
   - æ–‡ä»¶æƒé™ï¼š600
   - å®šæœŸå¤‡ä»½
   - ä¸è¦æäº¤åˆ°Git

3. **è®¿é—®æ—¥å¿—**
   - è®°å½•æ‰€æœ‰è®¿é—®æ“ä½œ
   - å¼‚å¸¸è®¿é—®å‘Šè­¦

4. **å¯†ç ç­–ç•¥**
   - ä½¿ç”¨å¼ºå¯†ç 
   - å®šæœŸæ›´æ¢å¯†ç 
   - ä¸åŒæœåŠ¡ä½¿ç”¨ä¸åŒå¯†ç 

---

## ğŸ“ ä¸‹ä¸€æ­¥

1. **åˆ›å»ºæ•°æ®åº“ç»“æ„**
2. **å®ç°åŠ å¯†åŠŸèƒ½**
3. **å¼€å‘ç®¡ç†å·¥å…·**
4. **æä¾›APIæ¥å£**
5. **é›†æˆåˆ°æ•°å­—äººç³»ç»Ÿ**

---

*è®¾è®¡æ—¥æœŸï¼š2024å¹´*
